(function ($) {
    "use strict";

    /*----------------------------
       stickey menu
    ----------------------------*/
    $(window).on('scroll', function () {
        var scroll = $(window).scrollTop();
        if (scroll < 165) {
            $(".sticky-header").removeClass("sticky");
        } else {
            $(".sticky-header").addClass("sticky");
        }
    });

    /*----------------------------
    jQuery MeanMenu
    ------------------------------ */
    $('.mobile-menu nav').meanmenu({
        meanScreenWidth: "9901",
        meanMenuContainer: ".mobile-menu",
        onePage: true,
    });

    /* slider activation */
    $('.slider_list').owlCarousel({
        loop: true,
        nav: true,
        autoplay: false,
        autoplayTimeout: 8000,
        navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
        items: 1,
    });
    $('.features_product_active').owlCarousel({
        loop: true,
        nav: true,
        autoplay: false,
        autoplayTimeout: 5000,
        navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
        items: 6,
        responsiveClass: true,
        responsive: {
            0: {
                items: 1,
                nav: true
            },
            480: {
                items: 2,
                nav: true
            },
            768: {
                items: 3,
                nav: false
            },
            992: {
                items: 4,
                nav: false
            },
            1200: {
                items: 5,
                nav: true,
                loop: false
            },
            1600: {
                items: 7,
                nav: true,
                loop: false
            }
        }
    });
    $('.shop-product_list').owlCarousel({
        loop: true,
        nav: false,
        autoplay: false,
        autoplayTimeout: 5000,
        navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
        items: 5,
        responsiveClass: true,
        responsive: {
            0: {
                items: 1,
                nav: true
            },
            480: {
                items: 2,
                nav: true
            },
            768: {
                items: 2,
                nav: false
            },
            992: {
                items: 3,
                nav: false
            },

            1300: {
                items: 4,
                nav: true,
                loop: false
            },
            1600: {
                items: 5,
                nav: true,
                loop: false
            }
        }
    });

    $('.best_selling_product_list').owlCarousel({
        loop: true,
        nav: false,
        autoplay: false,
        autoplayTimeout: 5000,
        navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
        items: 5,
        responsiveClass: true,
        responsive: {
            0: {
                items: 1,
                nav: true
            },
            575: {
                items: 2,
                nav: true
            },
            768: {
                items: 2,
                nav: false
            },
            992: {
                items: 3,
                nav: false
            },
            1500: {
                items: 4,
                nav: true,
                loop: false
            }
        }
    });

    $('.category_product_active').owlCarousel({
        loop: true,
        nav: true,
        autoplay: false,
        autoplayTimeout: 5000,
        navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
        items: 3,
        responsiveClass: true,
        responsive: {
            0: {
                items: 1,
                nav: true
            },
            480: {
                items: 2,
                nav: true
            },
            768: {
                items: 3,
                nav: false
            },
            992: {
                items: 2,
                nav: false
            },
            1200: {
                items: 3,
                nav: false
            },
        }
    });

    $('.brand_list_carousel').owlCarousel({
        loop: true,
        nav: true,
        autoplay: false,
        autoplayTimeout: 5000,
        navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
        items: 5,
        responsiveClass: true,
        responsive: {
            320: {
                items: 1,
                nav: true
            },
            480: {
                items: 2,
                nav: true
            },
            768: {
                items: 3,
                nav: false
            },
            991: {
                items: 4,
                nav: false
            },
            1200: {
                items: 5,
                nav: false
            },
        }
    });
    $('.features_product_three_active').owlCarousel({
        loop: true,
        nav: true,
        autoplay: false,
        autoplayTimeout: 5000,
        navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
        items: 4,
        responsiveClass: true,
        responsive: {
            0: {
                items: 1,
                nav: true
            },
            480: {
                items: 2,
                nav: true
            },
            768: {
                items: 3,
                nav: false
            },
            992: {
                items: 3,
                nav: false
            },
            1200: {
                items: 4,
                nav: true,
                loop: false
            },
        }
    });

    $('.features_product_four_active').owlCarousel({
        loop: true,
        nav: true,
        autoplay: false,
        autoplayTimeout: 5000,
        navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
        items: 4,
        responsiveClass: true,
        responsive: {
            0: {
                items: 1,
                nav: true
            },
            480: {
                items: 2,
                nav: true
            },
            768: {
                items: 2,
                nav: false
            },
            992: {
                items: 3,
                nav: false
            },
            1200: {
                items: 4,
                nav: true,
                loop: false
            },
        }
    });
    $('.pos_special_active').owlCarousel({
        loop: true,
        nav: true,
        autoplay: false,
        autoplayTimeout: 5000,
        navText: ['<i class="fa fa-angle-left"></i> prev', 'next <i class="fa fa-angle-right"></i>'],
        items: 1,
    });
    $('.features_product_active_three').owlCarousel({
        loop: true,
        nav: true,
        autoplay: false,
        autoplayTimeout: 5000,
        navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
        items: 5,
        responsiveClass: true,
        responsive: {
            0: {
                items: 1,
                nav: true
            },
            480: {
                items: 2,
                nav: true
            },
            768: {
                items: 3,
                nav: false
            },
            992: {
                items: 4,
                nav: false
            },
            1200: {
                items: 5,
                nav: true,
                loop: false
            },
        }
    });

    $('.features_product_active_four').owlCarousel({
        loop: true,
        nav: true,
        autoplay: false,
        autoplayTimeout: 5000,
        navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
        items: 5,
        responsiveClass: true,
        responsive: {
            0: {
                items: 1,
                nav: true
            },
            480: {
                items: 2,
                nav: true
            },
            768: {
                items: 3,
                nav: false
            },
            992: {
                items: 4,
                nav: false
            },
            1200: {
                items: 5,
                nav: true,
                loop: false
            },
        }
    });

    $('.best_selling_product_three').owlCarousel({
        loop: true,
        nav: true,
        autoplay: false,
        autoplayTimeout: 5000,
        navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
        items: 1,
        responsiveClass: true,
        responsive: {
            0: {
                items: 1,
                nav: true
            },
            480: {
                items: 1,
                nav: false
            },
            992: {
                items: 1,
                nav: false
            },
        }
    });

    $('.related_product_active').owlCarousel({
        loop: true,
        nav: true,
        autoplay: false,
        autoplayTimeout: 5000,
        navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
        items: 4,
        responsiveClass: true,
        responsive: {
            0: {
                items: 1,
                nav: true
            },
            480: {
                items: 2,
                nav: false
            },
            768: {
                items: 3,
                nav: false
            },
            992: {
                items: 4,
                nav: false
            },
        }
    });

    $('.product_nav_active').owlCarousel({
        loop: true,
        nav: true,
        autoplay: false,
        autoplayTimeout: 5000,
        navText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
        items: 3,
    });

    $('.testimonial___wrapper').owlCarousel({
        loop: true,
        nav: true,
        items: 1,
        autoplay: true,
    });
    /*------ Wow activation ----*/
    new WOW().init();

    /*--------------------------
     ScrollUp
    ---------------------------- */
    $.scrollUp({
        scrollText: '<i class="fa fa-angle-double-up"></i>',
        easingType: 'linear',
        scrollSpeed: 900,
        animation: 'fade'
    });

    /*header_account slideToggle*/

    $(".account_inner > a").on("click", function () {
        $('.content-setting-dropdown').slideToggle('medium');
    });

    /*countdown activation*/

    $('[data-countdown]').each(function () {
        var $this = $(this), finalDate = $(this).data('countdown');
        $this.countdown(finalDate, function (event) {
            $this.html(event.strftime('<div class="countdown_area"><div class="single_coutdown"><div class="content-number">%D</div><div class="content-title">DAYS</div></div><div class="single_coutdown"><div class="content-number">%H</div><div class="content-title">HOURS</div></div><div class="single_coutdown"><div class="content-number">%M</div><div class="content-title">MINUTES</div></div><div class="single_coutdown"><div class="content-number">%S</div><div class="content-title">SECONDS</div></div></div>'));
        });
    });

    /*----------------------------
        Cart Plus Minus Button
    ------------------------------ */
    var CartPlusMinus = $('.cart-plus-minus');

    CartPlusMinus.prepend('<div class="dec qtybutton">-</div>');
    CartPlusMinus.append('<div class="inc qtybutton">+</div>');
    $('.qtybutton').on('click', function () {
        var $button = $(this);
        var oldValue = $button.parent().find('input').val();
        if ($button.text() === "+") {
            var newVal = parseFloat(oldValue) + 1;
        } else {
            // Don't allow decrementing below zero
            if (oldValue > 0) {
                var newVal = parseFloat(oldValue) - 1;
            } else {
                newVal = 1;
            }
        }
        $button.parent().find('input').val(newVal);
    });
    /*----------------------------
        slider-range here
    ------------------------------ */
    $("#slider-range").slider({
        range: true,
        min: 0,
        max: 500,
        values: [75, 300],
        slide: function (event, ui) {
            $("#amount").val("$" + ui.values[0] + " - $" + ui.values[1]);
        }
    });
    $("#amount").val("$" + $("#slider-range").slider("values", 0) +
        " - $" + $("#slider-range").slider("values", 1));
    /*------------------------
        video popup here
     -----------------------*/

    $('.video__trigger').magnificPopup({
        type: 'iframe',
        mainClass: 'mfp-fade',
        removalDelay: 160,
        preloader: false,
        zoom: {
            enabled: true,
        }
    });

    /*------------------------------
      Category menu Activation
    ------------------------------*/
    $(".button_categories h4 > a").on("click", function () {
        $('.categories_menu').slideToggle();
    });
    $('#cat_toggle li.has-sub > a,.shop_toggle li.has-sub > a').on('click', function () {
        $(this).removeAttr('href');
        var element = $(this).parent('li');
        if (element.hasClass('open')) {
            element.removeClass('open');

            element.find('li').removeClass('open');

            element.find('ul').slideUp();
        }
        else {
            element.addClass('open');
            element.children('ul').slideDown();
            element.siblings('li').children('ul').slideUp();
            element.siblings('li').removeClass('open');
            element.siblings('li').find('li').removeClass('open');
            element.siblings('li').find('ul').slideUp();
        }
    });
    $('#cat_toggle > ul > li.has-sub > a,.shop_toggle li.has-sub > a').append('<span class="holder"></span>');

    /*------------------------------
      Active
    ------------------------------*/
    $(function () {
        $('ul.navbar_head li a').filter(function () { return this.href == location.href }).parent().addClass('active').siblings().removeClass('active')
        $('ul.navbar_head li a').click(function () {
            $(this).parent().addClass('active').siblings().removeClass('active')
        })
    })

    $(function () {
        $('ul.shop_toggle li a').filter(function () { return this.href == location.href }).parent().addClass('active').siblings().removeClass('active')
        $('ul.shop_toggle li a').click(function () {
            $(this).parent().addClass('active').siblings().removeClass('active')
        })
    })

    /*------------------------------
     ADD TO CART
   ------------------------------*/
    $(".product__hover ul li .addcart").click(function (e) {
        $.ajax({
            url: "/Cart/AddToCart",
            data: { idpro: $(this).attr("idpro"), quantity: $(this).attr("quantity"), weight: $(this).attr("weight") },
            success: function (response) {
                //response : object , text, view,...
                $.ajax({
                    url: "/Cart/MiniCartHeader",
                    success: function (response) {
                        $(".mini__cart").html(response);
                    }
                });
            }
        });
        e.preventDefault();
    })
    /*------------------------------
     DETAIL PRODUCT
   ------------------------------*/
    //$(".detail_product_incart").click(function (e) {
    //    $.ajax({
    //        url: "/SanPham/ChiTietSanPham",
    //        data: { idpro: $(this).attr("idpro") },
    //        success: function (response) {
    //            //response : object , text, view,...
    //            //$.ajax({
    //            //    url: "/Cart/MiniCartHeader",
    //            //    success: function (response) {
    //            //        $(".mini__cart").html(response);
    //            //    }
    //            //});
    //            $(".bodycontent2").html(response);
    //        }
    //    });
    //    //var targetUrl = '/chi-tiet-san-pham-' + $(this).attr("idpro");
    //    //location.href = targetUrl;
    //    e.preventDefault();
    /*})*/

    /*------------------------------
     CHANGE QUALITY IN CART
   ------------------------------*/
    $(".qtybutton").on('click', function () {
        alert($(this).parent().find('input').attr("idpro"))
        $.ajax({
            url: "/Cart/UpdateCart",
            data: { idpro: $(this).parent().find('input').attr("idpro"), quantity: $(this).parent().find('input').val(), weight: $('select[name="weight"]').val() },
            success: function (reponse) {
                $.ajax({
                    url: "/Cart/CartIndex",
                    success: function (response) {
                        window.location.href = "/Cart/CartIndex";
                        //$(".body_cart").empty;
                        /*$(".cart_main_area").html(response);*/
                    }
                });
            }
        })
    })
    /*------------------------------
    CHANGE WEIGHT IN CART
    ------------------------------*/
    $('.weight').change(function () {
        $.ajax({
            url: "/Cart/UpdateCart",
            data: { idpro: $(this).attr("idpro"), quantity: $(this).attr("quantity"), weight: $(this).val() },
            success: function (reponse) {
                $.ajax({
                    url: "/Cart/CartIndex",
                    success: function (response) {
                        window.location.href = "/Cart/CartIndex";
                        //$(".body_cart").empty;
                        /*$(".cart_main_area").html(response);*/
                    }
                });
            }
        })
        alert($(this).attr("quantity"))
    });
    /*------------------------------
    CHANGE CATEGORY IN SHOP IN INDEX
    ------------------------------*/
    $('.danhmuc li a').click(function (e) {
        $.ajax({
            url: "/Home/ShopInIndex",
            data: { iddanhmuc: $(this).attr("iddanhmuc") },
            success: function (response) {
                $(".shopinindex").html(response);
            }
        })
        e.preventDefault();
        alert($(this).attr("iddanhmuc"));
    });

    /*------------------------------
    PHÂN TRANG - SHOPINDEX
    ------------------------------*/
    $(".page_list_clearfix ul li a").click(function (e) {
        var pagelinkThis = $(this);
        $.ajax({
            url: "/SanPham/PhanTrang_ShopIndex/",
            data: { page: $(pagelinkThis).attr('data-page') },
            success: function (response) {
                $("#shop_active").html(response);

                $('.page_list_clearfix ul li').removeClass('current_page');
                /* $('.page_list_clearfix ul li a').filter(function () { return this.href == location.href }).parent().addClass('current_page').siblings().removeClass('current_page')*/
                $(pagelinkThis).parent().addClass('current_page');

                /*$('page_list_clearfix li').parent().addClass("active");*/
            }
        })
        e.preventDefault();
    })
    /*------------------------------
    PHÂN TRANG - SHOPINDEX -previous page
    ------------------------------*/
    $(".prev").click(function (e) {
        var pagelinkThis = $(".current_page a").attr("data-page");
        if (pagelinkThis <= 1) {
            pagelinkThis == 1;
        }
        else {
            pagelinkThis = pagelinkThis - 1;
        }
        $.ajax({
            url: "/SanPham/PhanTrang_ShopIndex/",
            data: { page: pagelinkThis },
            success: function (response) {
                $("#shop_active").html(response);

                $('.page_list_clearfix ul li').removeClass('current_page');
                /* $('.page_list_clearfix ul li a').filter(function () { return this.href == location.href }).parent().addClass('current_page').siblings().removeClass('current_page')*/
                $(pagelinkThis).parent().addClass('current_page');

                /*$('page_list_clearfix li').parent().addClass("active");*/
            }
        })
        alert(pagelinkThis);
        e.preventDefault();
    })
    /*------------------------------
   PHÂN TRANG - SHOPINDEX -previous page
   ------------------------------*/
    $(".next").click(function (e) {
        var pagelinkThis = $(".current_page a").attr("data-page");//lay trang hien tai
        var totalpage = $(".next a").attr("data-max-page");
        if (pagelinkThis >= totalpage) {
            pagelinkThis == totalpage;
        }
        //else {
        //    pagelinkThis = pagelinkThis + 1;
        //}
        //$.ajax({
        //    url: "/SanPham/PhanTrang_ShopIndex/",
        //    data: { page: $(pagelinkThis).attr('data-page') },
        //    success: function (response) {
        //        $("#shop_active").html(response);

        //        $('.page_list_clearfix ul li').removeClass('current_page');
        //        /* $('.page_list_clearfix ul li a').filter(function () { return this.href == location.href }).parent().addClass('current_page').siblings().removeClass('current_page')*/
        //        $(pagelinkThis).parent().addClass('current_page');

        //        /*$('page_list_clearfix li').parent().addClass("active");*/
        //    }
        //})
        alert($(".next a").attr("data-max-page"));
        e.preventDefault();
    })
})(jQuery);